(this.webpackJsonppaxos=this.webpackJsonppaxos||[]).push([[0],{131:function(e,t,r){},132:function(e,t,r){},140:function(e,t,r){"use strict";r.r(t);var n,o=r(0),s=r.n(o),a=r(43),c=r.n(a),i=(r(131),r(132),r(26)),l=r(18),u=r(28),p=r(50),d=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object(u.a)(this,e),this.number=t,this.value=r};!function(e){e[e.Acceptor=0]="Acceptor",e[e.Proposer=1]="Proposer"}(n||(n={}));var h,b=function(){function e(t,r){Object(u.a)(this,e),this.errorPercentage=void 0,this.nodeType=void 0,this.maxAcceptableProposalNumber=void 0,this.previousProposal=void 0,this.id=void 0,this.x=void 0,this.y=void 0,this.d3Id=void 0,this.errorPercentage=t,this.nodeType=r,this.x=0,this.y=0,this.maxAcceptableProposalNumber=0,this.previousProposal=new d,this.id=e.uniqueId++,this.d3Id=e.d3UniqueId++}return Object(p.a)(e,[{key:"failsRequest",value:function(){return this.errorPercentage>Math.random()}},{key:"handlePrepare",value:function(e){if(this.failsRequest())throw new Error("Randomly failed to respond to prepare request");if(e<this.maxAcceptableProposalNumber)throw new Error("Proposal number is too low to accept. Maximum acceptable value is "+this.maxAcceptableProposalNumber);return this.maxAcceptableProposalNumber=e,this.previousProposal}},{key:"handlePropose",value:function(e){if(this.failsRequest())throw new Error("Randomly failed to respond to propose request");if(e.number<this.maxAcceptableProposalNumber)throw new Error("Proposal number is too low to accept. Maximum acceptable value is "+this.maxAcceptableProposalNumber);this.maxAcceptableProposalNumber=e.number,this.previousProposal=e}}],[{key:"resetIdCounter",value:function(){this.uniqueId=0}}]),e}();b.d3UniqueId=0,b.uniqueId=0,function(e){e.Info="INFO",e.Error="ERROR"}(h||(h={}));var j=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.Info,n=arguments.length>2?arguments[2]:void 0;Object(u.a)(this,e),this.id=t,this.level=r,this.message=n};function f(e,t){if(b.uniqueId=0,e<=0)throw new Error("Number must be positive/nonzero");var r=new v,o=new b(t,n.Proposer);r.registerNode(o),r.proposerId=o.id;for(var s=1;s<e;s++){var a=new b(t,n.Acceptor);r.registerNode(a)}return r}var v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];Object(u.a)(this,e),this.nodes=void 0,this.nodeIdLookup=void 0,this._proposerId=void 0,this.chosenValue=void 0,this.eventLog=void 0,this.nodeIdLookup={},this.nodes=[],this.eventLog=[];var r,n=Object(l.a)(t);try{for(n.s();!(r=n.n()).done;){var o=r.value;this.registerNode(o)}}catch(s){n.e(s)}finally{n.f()}}return Object(p.a)(e,[{key:"proposer",get:function(){if(void 0===this._proposerId)throw new Error("There is no proposer id set");return this.nodeIdLookup[this._proposerId]}},{key:"proposerId",get:function(){return void 0!==this._proposerId?this._proposerId:-1},set:function(e){void 0!==this._proposerId&&(this.nodeIdLookup[this._proposerId].nodeType=n.Acceptor),this.nodeIdLookup[e].nodeType=n.Proposer,this._proposerId=e}},{key:"registerNode",value:function(e){this.nodeIdLookup[e.id]=e,this.nodes.push(e)}},{key:"propose",value:function(e){var t,r=0,n=Object(l.a)(this.nodes);try{for(n.s();!(t=n.n()).done;){var o=t.value;try{o.handlePropose(e),r++}catch(a){var s=void 0;s=a instanceof Error?a.message:String(a),this.eventLog.push(new j(o.id,h.Error,s))}}}catch(c){n.e(c)}finally{n.f()}r>this.nodes.length/2?(this.chosenValue=e.value,this.eventLog.push(new j(this.proposerId,h.Info,"Received "+r+"/"+this.nodes.length+" responses. Value '"+e.value+"' has been chosen"))):this.eventLog.push(new j(this.proposerId,h.Info,"Received "+r+"/"+this.nodes.length+" responses. Did not received enough responses from acceptor for value "+e.value+" to be chosen"))}},{key:"prepare",value:function(e,t){var r,n=new d,o=0,s=Object(l.a)(this.nodes);try{for(s.s();!(r=s.n()).done;){var a=r.value;try{var c=a.handlePrepare(e);c.number>n.number&&(n=c),o++}catch(u){var i=void 0;i=u instanceof Error?u.message:String(u),this.eventLog.push(new j(a.id,h.Error,i))}}}catch(p){s.e(p)}finally{s.f()}o>this.nodes.length/2?(n.number>-1&&(this.eventLog.push(new j(this.proposerId,h.Info,"Highest numbered proposal recieved ('"+n.value+"') in prepare overwrites submitted proposal value")),t=n.value),this.propose(new d(e,t))):this.eventLog.push(new j(this.proposerId,h.Info,"A majority of nodes did not respond to prepare request. Proposal will not be sent"))}}]),e}(),x=r(64),g=r(65),O=r(66),m=r(58),P=r(4);function w(e){var t=e.showDescription?Object(P.jsx)(m.b,{}):Object(P.jsx)(m.a,{});return Object(P.jsxs)(x.g,{spacing:3,alignItems:"flex-start",children:[Object(P.jsx)(x.d,{size:"2xl",align:"left",children:"Paxos Visualization"}),Object(P.jsx)(g.a,{in:e.showDescription,children:Object(P.jsx)(x.f,{align:"left",children:"A way to visualize the how the rules that govern the Paxos protocol can acheive consensus in a distributed network. The network of nodes is visualized on the right. Refer to Paxos Made Simple (or the Part-Time Parliament) by Leslie Lamport for a listing of the rules that the Paxos protocol follows. There are 3 main node roles in Paxos: Acceptor, Proposer, and Learner. Here we focus on the Acceptor and Proposer role and have the Proposer serve as an Acceptor as well. The Proposer appears in green in the network and can be changed by selecting any node."})}),Object(P.jsx)(O.a,{align:"left",onClick:e.onCollapse,children:t})]})}var y=r(67);function I(e){var t=e.eventLog.map((function(e,t){return Object(P.jsxs)(y.g,{children:[Object(P.jsx)(y.d,{children:e.id}),Object(P.jsx)(y.d,{children:e.level}),Object(P.jsx)(y.d,{children:e.message})]},t)}));return Object(P.jsxs)(y.a,{children:[Object(P.jsx)(y.b,{children:"event logs from nodes within network"}),Object(P.jsx)(y.f,{children:Object(P.jsxs)(y.g,{children:[Object(P.jsx)(y.e,{children:"ID"}),Object(P.jsx)(y.e,{children:"Log Level"}),Object(P.jsx)(y.e,{children:"Message"})]})}),Object(P.jsx)(y.c,{children:t})]})}var k=r(25);var N=function(e){var t=Object(o.useRef)(null),r=Object(o.useRef)();return Object(o.useEffect)((function(){function e(){var e=0,n=0;t.current&&(e=t.current.width.baseVal.value,n=t.current.height.baseVal.value),r.current&&(r.current.stop(),r.current.force("center",k.b(e/2,n/2)),r.current.restart())}return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}})),Object(o.useEffect)((function(){console.log(r.current);var o=0,s=0;t.current&&(o=t.current.width.baseVal.value,s=t.current.height.baseVal.value);var a=function(e){for(var t=[],r=0;r<e.length-1;r++)for(var n=r;n<e.length;n++)t.push({source:e[r].id,target:e[n].id});return t}(e.paxosProtocolNetwork.nodes);r.current=function(e,r,o,s,a){var c=k.f(t.current),i=c.selectAll("line").data(r,(function(e){return e.source.id+"-"+e.target.id})).join((function(e){return e.append("line").style("stroke","#aaa")}));console.log(e);var l=c.selectAll("g.node").data(e,(function(e){return e.d3Id})).join((function(e){var t=e.append("g").attr("class","node");return t.append("circle").attr("r",30).attr("class","body").style("fill",(function(e){return e.nodeType===n.Acceptor?"gray":"green"})),t.append("circle").attr("r",10).attr("class","id").attr("cy",-20).attr("cx",-19).style("fill","white"),t.append("text").attr("class","id").style("text-anchor","middle").attr("y",-15).attr("x",-19).text((function(e){return e.id})),t.append("text").attr("class","proposal").style("text-anchor","middle").attr("y",8).text((function(e){return e.previousProposal.number+"/"+e.previousProposal.value+"/"+e.maxAcceptableProposalNumber})),t}),(function(e){return e.selectAll("circle.body").style("fill",(function(e){return console.log(e),e.nodeType===n.Acceptor?"gray":"green"})),e.selectAll("text.proposal").text((function(e){return e.previousProposal.number+"/"+e.previousProposal.value+"/"+e.maxAcceptableProposalNumber})),e.raise(),e})),u=k.e(e).force("link",k.c().id((function(e){return e.id})).links(r)).force("charge",k.d().strength(-800)).force("center",k.b(o/2,s/2)).on("tick",(function(){i.attr("x1",(function(e){return e.source.x})).attr("y1",(function(e){return e.source.y})).attr("x2",(function(e){return e.target.x})).attr("y2",(function(e){return e.target.y})),l.attr("transform",(function(e){return"translate("+e.x+","+e.y+")"}))}));return l.on("click",(function(e,t){return a(t.id)})),l.call(function(e){return k.a().on("start",(function(t){t.active||e.alphaTarget(.3).restart(),t.subject.fx=t.subject.x,t.subject.fy=t.subject.y})).on("drag",(function(e){e.subject.fx=e.x,e.subject.fy=e.y})).on("end",(function(t){t.active||e.alphaTarget(0),t.subject.fx=null,t.subject.fy=null}))}(u)),u}(e.paxosProtocolNetwork.nodes,a,o,s,e.onProposerChange)}),[e.paxosProtocolNetwork]),Object(P.jsx)("svg",{className:"container",width:"100%",height:"100%",ref:t})},C=r(71),A=r(34),L=r(68),S=r(69);function E(e){return Object(P.jsxs)(x.e,{columns:2,columnGap:3,rowGap:6,w:"full",children:[Object(P.jsx)(x.c,{colSpan:e.colSpan,children:Object(P.jsxs)(A.a,{children:[Object(P.jsx)(A.b,{children:"Proposal Number"}),Object(P.jsxs)(L.c,{value:e.proposalNumber,min:e.minProposalValue,onChange:e.onProposalNumberChange,children:[Object(P.jsx)(L.d,{}),Object(P.jsxs)(L.e,{children:[Object(P.jsx)(L.b,{}),Object(P.jsx)(L.a,{})]})]})]})}),Object(P.jsx)(x.c,{colSpan:e.colSpan,children:Object(P.jsxs)(A.a,{children:[Object(P.jsx)(A.b,{children:"Proposal Value"}),Object(P.jsx)(S.a,{placeholder:"Fill in any value (e.g. 'foo')",value:e.proposalValue,onChange:e.onProposalValueChange})]})}),Object(P.jsx)(x.c,{colSpan:2,children:Object(P.jsx)(O.a,{size:"lg",w:"full",onClick:function(){return e.onPropose(e.proposalNumber,e.proposalValue)},children:"Propose Value"})})]})}var V=r(70);function T(e){return Object(P.jsxs)(x.e,{columns:2,columnGap:3,rowGap:6,w:"full",children:[Object(P.jsx)(x.c,{colSpan:e.colSpan,children:Object(P.jsxs)(A.a,{children:[Object(P.jsx)(A.b,{children:"Number of Nodes"}),Object(P.jsxs)(L.c,{value:e.nodeCount,min:3,max:25,onChange:function(t){return e.onNodeCountChange(t)},children:[Object(P.jsx)(L.d,{}),Object(P.jsxs)(L.e,{children:[Object(P.jsx)(L.b,{}),Object(P.jsx)(L.a,{})]})]})]})}),Object(P.jsx)(x.c,{colSpan:e.colSpan,children:Object(P.jsxs)(A.a,{children:[Object(P.jsx)(A.b,{children:"Error Percentage"}),Object(P.jsx)(V.a,{label:"Chance for a request to a node to fail",children:Object(P.jsxs)(L.c,{value:e.errorPercentage,min:0,max:1,step:.01,onChange:function(t){return e.onErrorPercentageChange(t)},children:[Object(P.jsx)(L.d,{}),Object(P.jsxs)(L.e,{children:[Object(P.jsx)(L.b,{}),Object(P.jsx)(L.a,{})]})]})})]})}),Object(P.jsx)(x.c,{colSpan:2,children:Object(P.jsx)(O.a,{size:"lg",w:"full",onClick:function(){return e.onGenerateGraph(e.nodeCount,e.errorPercentage)},children:"Generate Graph"})})]})}function q(){var e=Object(C.a)({base:2,md:1}),t=Object(o.useState)(5),r=Object(i.a)(t,2),n=r[0],s=r[1],a=Object(o.useState)(0),c=Object(i.a)(a,2),l=c[0],u=c[1],p=Object(o.useState)(""),d=Object(i.a)(p,2),h=d[0],b=d[1],j=Object(o.useState)(0),g=Object(i.a)(j,2),O=g[0],m=g[1],y=Object(o.useState)(0),k=Object(i.a)(y,2),A=k[0],L=k[1],S=Object(o.useState)(f(n,l)),V=Object(i.a)(S,2),q=V[0],R=V[1],G=Object(o.useState)(!0),z=Object(i.a)(G,2),_=z[0],F=z[1];return Object(P.jsxs)(x.a,{maxWidth:"container.xl",padding:0,children:[Object(P.jsxs)(x.b,{h:{base:"auto"},py:[0,5],direction:{base:"column-reverse",md:"row"},children:[Object(P.jsxs)(x.g,{w:"full",h:"full",p:10,spacing:10,alignItems:"flex-start",bg:"gray.50",children:[Object(P.jsx)(w,{showDescription:_,onCollapse:function(){return F(!_)}}),Object(P.jsx)(T,{nodeCount:n,errorPercentage:l,onNodeCountChange:function(e){return s(parseInt(e))},onErrorPercentageChange:function(e){return u(parseFloat(e))},onGenerateGraph:function(e,t){return function(e,t){R(f(e,t))}(e,t)}}),Object(P.jsx)(E,{proposalNumber:A,minProposalValue:O,onProposalNumberChange:function(e){return L(parseInt(e))},proposalValue:h,colSpan:e,onProposalValueChange:function(e){return b(e.target.value)},onPropose:function(e,t){return function(e,t){q.prepare(e,t),R(Object.assign(new v,q))}(e,t)}})]}),Object(P.jsx)(x.g,{w:"full",h:{base:"400px",md:"auto"},p:0,spacing:0,alignItems:"flex-start",children:Object(P.jsx)(N,{paxosProtocolNetwork:q,onProposerChange:function(e){m(q.nodeIdLookup[e].maxAcceptableProposalNumber),R((function(t){return t.proposerId=e,Object.assign(new v,q)}))}})})]}),Object(P.jsx)(I,{eventLog:q.eventLog})]})}var R=function(){return Object(P.jsx)("div",{className:"App",children:Object(P.jsx)(q,{})})},G=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,146)).then((function(t){var r=t.getCLS,n=t.getFID,o=t.getFCP,s=t.getLCP,a=t.getTTFB;r(e),n(e),o(e),s(e),a(e)}))},z=r(27);c.a.render(Object(P.jsx)(s.a.StrictMode,{children:Object(P.jsx)(z.a,{children:Object(P.jsx)(R,{})})}),document.getElementById("root")),G()}},[[140,1,2]]]);
//# sourceMappingURL=main.da956bde.chunk.js.map